<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOULINIRI OS v1.0</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --neon-green: #00ff00; --dark-bg: #0a0a0a; --panel-bg: #1a1a1a; }
        body { background: var(--dark-bg); color: var(--neon-green); font-family: 'Courier New', monospace; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }
        
        /* Box di Login Estetico */
        #auth-screen { background: var(--panel-bg); border: 2px solid var(--neon-green); padding: 30px; box-shadow: 0 0 20px rgba(0,255,0,0.2); border-radius: 10px; text-align: center; }
        .logo-y { font-size: 50px; font-weight: bold; margin-bottom: 10px; }
        
        input { background: #000; border: 1px solid #333; color: var(--neon-green); padding: 10px; margin: 5px; width: 80%; outline: none; }
        input:focus { border-color: var(--neon-green); }
        button { background: var(--neon-green); color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; margin: 5px; border-radius: 5px; }
        
        /* Interfaccia OS Post-Login */
        #os-interface { display: none; width: 90%; max-width: 1000px; height: 80vh; grid-template-columns: 1fr 1fr; grid-template-rows: auto 1fr auto; gap: 15px; }
        .panel { background: var(--panel-bg); border: 1px solid #333; padding: 15px; overflow: hidden; display: flex; flex-direction: column; }
        .panel-header { border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 10px; font-size: 12px; color: #888; }
        
        .chat-window, .terminal { flex-grow: 1; overflow-y: auto; font-size: 14px; background: #000; padding: 10px; border-radius: 5px; }
        .msg { margin-bottom: 8px; border-bottom: 1px solid #111; padding-bottom: 4px; }
        .msg.me { color: #fff; }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="logo-y">Y</div>
        <h2>YOULINIRI OS v1.0</h2>
        <p>Identificazione richiesta...</p>
        <input type="text" id="username" placeholder="Username"><br>
        <input type="password" id="password" placeholder="Password"><br>
        <button onclick="handleAuth('signup')">SIGN UP</button>
        <button onclick="handleAuth('login')">LOG IN</button>
    </div>

    <div id="os-interface">
        <div class="panel" style="grid-column: span 2;">
            <div class="panel-header"># system_status</div>
            USER: <span id="display-user">...</span> | MY ID YOULI: <span id="my-id">GENERATING...</span>
        </div>

        <div class="panel">
            <div class="panel-header"># terminal_log</div>
            <div id="terminal" class="terminal">SISTEMA PRONTO...</div>
        </div>

        <div class="panel">
            <div class="panel-header"># chat_window</div>
            <div id="chat" class="chat-window">Benvenuto nella rete YOULI.</div>
        </div>

        <div class="panel" style="grid-column: span 2;">
            <div class="panel-header"># send_command</div>
            <input type="text" id="dest-id" placeholder="ID DESTINATARIO" style="width: 30%;">
            <input type="text" id="msg-content" placeholder="SCRIVI MESSAGGIO O YOULI" style="width: 50%;">
            <button onclick="sendYouli()">INVIA</button>
        </div>
    </div>

    <script>
        let peer;
        let myUsername = "";

        function handleAuth(type) {
            const user = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            if (user.length < 3) return alert("Dati non validi");

            if (type === 'signup') {
                localStorage.setItem('upass_' + user, pass);
                alert("Registrato! Accedi ora.");
            } else {
                if (localStorage.getItem('upass_' + user) === pass) {
                    myUsername = user;
                    initOS();
                } else { alert("Accesso Negato"); }
            }
        }

        function initOS() {
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('os-interface').style.display = 'grid';
            document.getElementById('display-user').innerText = myUsername.toUpperCase();

            peer = new Peer(undefined, { host: '0.peerjs.com', port: 443, secure: true });

            peer.on('open', (id) => {
                document.getElementById('my-id').innerText = id;
                logTerminal("Connessione stabilita. ID: " + id);
            });

            peer.on('connection', (conn) => {
                conn.on('data', (data) => {
                    addChat(data.user, data.msg);
                });
            });
        }

        function sendYouli() {
            const id = document.getElementById('dest-id').value;
            const text = document.getElementById('msg-content').value;
            if(!id || !text) return;

            const conn = peer.connect(id);
            conn.on('open', () => {
                const payload = { user: myUsername, msg: text };
                conn.send(payload);
                addChat("IO", text, true);
                document.getElementById('msg-content').value = "";
            });
        }

        function addChat(user, msg, isMe = false) {
            const chat = document.getElementById('chat');
            const color = isMe ? "#fff" : "var(--neon-green)";
            chat.innerHTML += `<div class="msg" style="color:${color}"><b>${user}:</b> ${msg}</div>`;
            chat.scrollTop = chat.scrollHeight;
        }

        function logTerminal(txt) {
            const term = document.getElementById('terminal');
            term.innerHTML += `<br>> ${txt}`;
            term.scrollTop = term.scrollHeight;
        }
    </script>
</body>
</html>
